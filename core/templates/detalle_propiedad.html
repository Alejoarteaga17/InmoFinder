{% load static %}

<div class="modal-header">
    <h5 class="modal-title">{{ propiedad.nombre }}</h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
</div>

<div class="modal-body detalle-propiedad">

    <!-- Galer√≠a tipo slider -->
    <div class="galeria mb-3">
        {% if propiedad.mediapropiedad_set.exists %}
        <div class="slider">
            {% for media in propiedad.mediapropiedad_set.all %}
                {% if media.tipo == "imagen" %}
                    <div class="slide">
                        {% if media.archivo %}
                            <img src="{{ media.archivo.url }}" class="img-fluid rounded" alt="{{ propiedad.nombre }}">
                        {% else %}
                            <img src="{% static 'images/default.jpg' %}" class="img-fluid rounded" alt="Sin imagen disponible">
                        {% endif %}
                    </div>
                {% elif media.tipo == "video" %}
                    <div class="slide">
                        <video controls class="w-100 rounded">
                            {% if media.archivo %}
                                <source src="{{ media.archivo.url }}" type="video/mp4">
                            {% else %}
                                <source src="{% static 'images/muestra.mp4' %}" type="video/mp4">
                            {% endif %}
                            Tu navegador no soporta video.
                        </video>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
        {% else %}
            <img src="{% static 'images/default.jpg' %}" class="img-fluid rounded w-100" alt="Sin imagen">
        {% endif %}
    </div>

    <!-- Informaci√≥n de la propiedad -->
    <div class="info-propiedad">
        <p class="fw-bold text-success">Precio Total: $ {{ propiedad.precio_total|floatformat:0 }} COP</p>
        <p>
            <span class="price-m2-badge">
                ${{ propiedad.precio_m2|floatformat:0 }} COP/m¬≤
            </span>
        </p>

        <p class="text-muted">üìç {{ propiedad.ubicacion }}</p>

        <ul class="list-unstyled small">
            <li><b>√Årea:</b> {{ propiedad.area }} m¬≤</li>
            <li><b>Habitaciones:</b> {{ propiedad.habitaciones }}</li>
            <li><b>Ba√±os:</b> {{ propiedad.banos }}</li>
            <li><b>Parqueaderos:</b> {{ propiedad.parqueaderos }}</li>
            <li><b>Garaje:</b> {% if propiedad.garaje %}S√≠{% else %}No{% endif %}</li>
            <li><b>Mascotas:</b> {% if propiedad.mascotas %}Permitidas{% else %}No permitidas{% endif %}</li>
            <li><b>Disponibilidad:</b> {{ propiedad.fecha_disponibilidad }}</li>
        </ul>

        <h6>Descripci√≥n</h6>
        <p>{{ propiedad.descripcion }}</p>

        {% if propiedad.zonas_comunes %}
        <h6>Zonas comunes</h6>
        <p>{{ propiedad.zonas_comunes }}</p>
        {% endif %}
    </div>

<div class="interes mt-4 text-center">
    <h6>Interested?</h6>
    {% if user.is_authenticated %}
    <button class="btn btn-dark mt-2" 
        id="openContactBtn" 
        data-url="{% url 'contact_form' propiedad.id %}">
    Contact
</button>
    {% else %}
        <a href="{% url 'login' %}?next={{ request.path }}" class="btn btn-dark mt-2">
            Contact
        </a>
        <p class="small text-muted mt-2">You need an account to contact the owner.</p>
    {% endif %}
</div>
<div class="modal fade" id="contactModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content" id="contactModalContent">
            </div>
        </div>
    </div>
</div>


