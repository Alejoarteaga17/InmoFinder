{% extends "base.html" %}
{% load static %}

{% block title %}Home · InmoFinder{% endblock %}

{% block styles %}
<style>
  /* Espaciados */
  .hero { margin-top: var(--hero-gap); }
  .hero .lead { margin-top: 1.1rem; color: var(--muted); }

  /* Chips */
  .chips { gap: .5rem; }
  .chips .chip {
    font-size: .95rem;
    padding: .6rem 1.4rem;
    border: 1px solid var(--muted-3);
    border-radius: 50px;
    background: #fff;
    text-decoration: none;
    color: #333;
    transition: all 0.3s ease;
  }
  .chips .chip:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    border-color: var(--muted);
    color: var(--primary);
  }

  /* Imagen hero */
  .hero-img { border-radius: 24px; }

  /* Carrusel controles */
  .carousel-control-prev-icon,
  .carousel-control-next-icon {
    filter: invert(40%) sepia(90%) saturate(400%) hue-rotate(160deg);
    width: 40px;
    height: 40px;
  }
  .carousel-control-prev,
  .carousel-control-next {
    background: rgba(255,255,255,0.7);
    border-radius: 50%;
    width: 50px;
    height: 50px;
    top: 40%;
    transition: background .3s ease;
  }
  .carousel-control-prev:hover,
  .carousel-control-next:hover {
    background: rgba(255,255,255,0.95);
  }
</style>
{% endblock %}

{% block content %}
<section class="container hero">
  <div class="row align-items-center">
    <!-- Lado izquierdo -->
    <div class="col-lg-6">
      <h1 class="display-5 mb-0 text-ink">
        Smart real estate platform for buyers, sellers, and agents.
      </h1>

      <p class="lead space-h1-lead text-muted-1">
        Find, publish, and manage properties with ease. Our platform connects buyers, renters,
        and real estate professionals through verified listings, smart search filters,
        and secure communication tools.
      </p>

      <!-- Buscador -->
      <div class="controls-row d-flex align-items-center space-lead-search"> 
        <div class="search-wrap w-100 d-flex justify-content-center">
          <form method="get" action="{% url 'buscar_propiedades' %}" class="search position-relative width-100" style="max-width:430px;">
            <span class="search-icon"><i class="bi bi-search"></i></span>
            <input class="form-control search-input" type="text" name="search" placeholder="Buscar por ubicación, nombre o descripción">
          </form>
        </div>
      </div>

      <!-- Chips ubicaciones -->
      <div class="d-flex flex-wrap chips space-search-chips justify-content-center">
        <a href="{% url 'buscar_propiedades' %}?search=Poblado" class="chip"><i class="bi bi-geo-alt"></i> Poblado</a>
        <a href="{% url 'buscar_propiedades' %}?search=Envigado" class="chip"><i class="bi bi-geo-alt"></i> Envigado</a>
        <a href="{% url 'buscar_propiedades' %}?search=Laureles" class="chip"><i class="bi bi-geo-alt"></i> Laureles</a>
        <a href="{% url 'buscar_propiedades' %}?search=Sabaneta" class="chip"><i class="bi bi-geo-alt"></i> Sabaneta</a>
      </div>
    </div>

    <!-- Lado derecho -->
    <div class="col-lg-6 text-center mt-5 mt-lg-0">
      <img src="{% static 'images/default.jpg' %}" alt="Casa moderna" class="img-fluid shadow hero-img">
    </div>
    {% include "partials/buscador.html" %}
  </div>

  <!-- Carrusel de propiedades -->
  <h1 class="mb-4 text-center">Propiedades Disponibles</h1>

  {% if propiedades %}
  <div id="carouselPropiedades" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
      {% for propiedad in propiedades %}
        {% if forloop.counter0|divisibleby:4 %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
          <div class="row justify-content-center">
        {% endif %}

            <div class="col-md-3">
              <div class="card property-card shadow-sm">
                <a href="{% url 'detalle_propiedad' propiedad.id %}" 
                    class="view-property" 
                    data-bs-toggle="modal" 
                    data-bs-target="#propertyModal">
                  {% with propiedad.media.all|first as media %}
                    {% if media %}
                      <img src="{% static 'images/default.jpg' %}" class="card-img-top" alt="{{ propiedad.nombre }}">
                    {% else %}
                      <img src="{% static 'images/default.jpg' %}" class="card-img-top" alt="Sin imagen">
                    {% endif %}
                  {% endwith %}
                </a>
                <div class="card-body text-center">
                  <h5 class="card-title">{{ propiedad.nombre }}</h5>
                  <p class="fw-bold text-success">${{ propiedad.precio_total }}</p>
                  <p class="text-muted">{{ propiedad.ubicacion }}</p>
                  <p class="card-text text-truncate" style="-webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; display:-webkit-box;">
                    {{ propiedad.descripcion }}
                  </p>
                </div>
              </div>
            </div>

        {% if forloop.counter|divisibleby:4 or forloop.last %}
          </div>
        </div>
        {% endif %}
      {% endfor %}
    </div>

    <!-- Controles carrusel -->
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselPropiedades" data-bs-slide="prev" style="left:-100px;">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselPropiedades" data-bs-slide="next" style="right:-100px;">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
  {% else %}
  <p class="text-center">No hay propiedades disponibles.</p>
  {% endif %}
</section>
{% endblock %}
